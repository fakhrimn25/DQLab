# -*- coding: utf-8 -*-
"""Project Machine Learning with Python: Building Recommender System

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/10zm7XG1TqTp1inhOXR7mItEc6AndVvs7

# Formula dari IMDB dengan Weighted Rating

![image.png](data:image/png;base64,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)

dimana,

v: jumlah votes untuk film tersebut

m: jumlah minimum votes yang dibutuhkan supaya dapat masuk dalam chart

R: rata-rata rating dari film tersebut

C: rata-rata jumlah votes dari seluruh semesta film

# [Import Library dan File Unloading](https://academy.dqlab.id/main/projectcode/212/378/1876?pr=)
"""

#import library yang dibutuhkan
import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

#lakukan pembacaan dataset
movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t') #untuk menyimpan title_basics.tsv
rating_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.ratings.tsv', sep='\t') #untuk menyimpan title.ratings.tsv

"""# [5 Data teratas dari table movie](https://academy.dqlab.id/main/livecode/212/379/1877?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')

print(movie_df.head())

"""# [Info Data dari Setiap Kolom](https://academy.dqlab.id/main/livecode/212/379/1922?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')

print(movie_df.info())

"""# [Pengecekan Data dengan Nilai NULL](https://academy.dqlab.id/main/livecode/212/379/1923?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')

print(movie_df.isnull().sum())

"""# [Analisis Kolom dengan data bernilai NULL - part 1](https://academy.dqlab.id/main/livecode/212/379/1931?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')

print(movie_df.loc[(movie_df['primaryTitle'].isnull())|(movie_df['originalTitle'].isnull())])

"""# [Membuang Data dengan Nilai NULL - part 1](https://academy.dqlab.id/main/livecode/212/379/1932?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')

#mengupdate movie_df dengan membuang data-data bernilai NULL
movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull())&(movie_df['originalTitle'].notnull())]

#menampilkan jumlah data setelah data dengan nilai NULL dibuang
print(len(movie_df))

"""# [Analisis Kolom dengan data bernilai NULL - part 2](https://academy.dqlab.id/main/livecode/212/379/1933?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]

print(movie_df.loc[movie_df['genres'].isnull()])

"""# [Membuang Data dengan Nilai NULL - part 2](https://academy.dqlab.id/main/livecode/212/379/1934?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]

#mengupdate movie_df dengan membuang data-data bernilai NULL
movie_df = movie_df.loc[movie_df['genres'].notnull()]

#menampilkan jumlah data setelah data dengan nilai NULL dibuang
print(len(movie_df))

"""# [Mengubah Nilai '\\N'](https://academy.dqlab.id/main/livecode/212/379/1935?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]
movie_df = movie_df.loc[movie_df['genres'].notnull()]

#mengubah nilai '\\N' pada startYear menjadi np.nan dan cast kolomnya menjadi float64
movie_df['startYear'] = movie_df['startYear'].replace('\\N',np.nan)
movie_df['startYear'] = movie_df['startYear'].astype('float64')
print(movie_df['startYear'].unique()[:5])

#mengubah nilai '\\N' pada endYear menjadi np.nan dan cast kolomnya menjadi float64
movie_df['endYear'] = movie_df['endYear'].replace('\\N',np.nan)
movie_df['endYear'] = movie_df['endYear'].astype('float64')
print(movie_df['endYear'].unique()[:5])

#mengubah nilai '\\N' pada runtimeMinutes menjadi np.nan dan cast kolomnya menjadi float64
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].replace('\\N',np.nan)
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].astype('float64')
print(movie_df['runtimeMinutes'].unique()[:5])

"""# [Mengubah nilai genres menjadi list](https://academy.dqlab.id/main/livecode/212/379/1936?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]
movie_df = movie_df.loc[movie_df['genres'].notnull()]
movie_df['startYear'] = movie_df['startYear'].replace('\\N', np.nan)
movie_df['startYear'] = movie_df['startYear'].astype('float64')
movie_df['endYear'] = movie_df['endYear'].replace('\\N', np.nan)
movie_df['endYear'] = movie_df['endYear'].astype('float64')
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].replace('\\N', np.nan)
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].astype('float64')

def transform_to_list(x):
    if ',' in x: 
    #ubah menjadi list apabila ada data pada kolom genre
        return x.split(',')
    else: 
    #jika tidak ada data, ubah menjadi list kosong
        return []

movie_df['genres'] = movie_df['genres'].apply(lambda x: transform_to_list(x))

"""# [Menampilkan 5 data teratas](https://academy.dqlab.id/main/livecode/212/380/1937?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

rating_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.ratings.tsv', sep='\t')

print(rating_df.head())

"""# [Menampilkan info data](https://academy.dqlab.id/main/livecode/212/380/1938?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

rating_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.ratings.tsv', sep='\t')

print(rating_df.info())

"""# [Inner Join table movie dan table rating](https://academy.dqlab.id/main/livecode/212/381/1939?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')
rating_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.ratings.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]
movie_df = movie_df.loc[movie_df['genres'].notnull()]
movie_df['startYear'] = movie_df['startYear'].replace('\\N', np.nan)
movie_df['startYear'] = movie_df['startYear'].astype('float64')
movie_df['endYear'] = movie_df['endYear'].replace('\\N', np.nan)
movie_df['endYear'] = movie_df['endYear'].astype('float64')
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].replace('\\N', np.nan)
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].astype('float64')

def transform_to_list(x):
    if ',' in x: 
        return x.split(',')
    else: 
        return []

movie_df['genres'] = movie_df['genres'].apply(lambda x: transform_to_list(x))

#Lakukan join pada kedua table
movie_rating_df = pd.merge(movie_df, rating_df, on='tconst', how='inner')

#Tampilkan 5 data teratas
print(movie_rating_df.head())

#Tampilkan tipe data dari tiap kolom
print(movie_rating_df.info())

"""# [Memperkecil ukuran Table](https://academy.dqlab.id/main/livecode/212/381/1940?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')
rating_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.ratings.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]
movie_df = movie_df.loc[movie_df['genres'].notnull()]
movie_df['startYear'] = movie_df['startYear'].replace('\\N', np.nan)
movie_df['startYear'] = movie_df['startYear'].astype('float64')
movie_df['endYear'] = movie_df['endYear'].replace('\\N', np.nan)
movie_df['endYear'] = movie_df['endYear'].astype('float64')
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].replace('\\N', np.nan)
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].astype('float64')

def transform_to_list(x):
    if ',' in x: 
        return x.split(',')
    else: 
        return []

movie_df['genres'] = movie_df['genres'].apply(lambda x: transform_to_list(x))

movie_rating_df = pd.merge(movie_df, rating_df, on='tconst', how='inner')
movie_rating_df = movie_rating_df.dropna(subset=['startYear','runtimeMinutes'])

#Untuk memastikan bahwa sudah tidak ada lagi nilai NULL
print(movie_rating_df.info())

"""# [Pertanyaan 1: Berapa nilai C?](https://academy.dqlab.id/main/livecode/212/382/1941?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')
rating_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.ratings.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]
movie_df = movie_df.loc[movie_df['genres'].notnull()]
movie_df['startYear'] = movie_df['startYear'].replace('\\N', np.nan)
movie_df['startYear'] = movie_df['startYear'].astype('float64')
movie_df['endYear'] = movie_df['endYear'].replace('\\N', np.nan)
movie_df['endYear'] = movie_df['endYear'].astype('float64')
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].replace('\\N', np.nan)
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].astype('float64')

def transform_to_list(x):
    if ',' in x: 
        return x.split(',')
    else: 
        return []

movie_df['genres'] = movie_df['genres'].apply(lambda x: transform_to_list(x))

movie_rating_df = pd.merge(movie_df, rating_df, on='tconst', how='inner')
movie_rating_df = movie_rating_df.dropna(subset=['startYear','runtimeMinutes'])

C = movie_rating_df['averageRating'].mean()
print(C)

"""# [Pertanyaan 2: Berapa nilai m?](https://academy.dqlab.id/main/livecode/212/382/1942?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')
rating_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.ratings.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]
movie_df = movie_df.loc[movie_df['genres'].notnull()]
movie_df['startYear'] = movie_df['startYear'].replace('\\N', np.nan)
movie_df['startYear'] = movie_df['startYear'].astype('float64')
movie_df['endYear'] = movie_df['endYear'].replace('\\N', np.nan)
movie_df['endYear'] = movie_df['endYear'].astype('float64')
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].replace('\\N', np.nan)
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].astype('float64')

def transform_to_list(x):
    if ',' in x: 
        return x.split(',')
    else: 
        return []

movie_df['genres'] = movie_df['genres'].apply(lambda x: transform_to_list(x))

movie_rating_df = pd.merge(movie_df, rating_df, on='tconst', how='inner')
movie_rating_df = movie_rating_df.dropna(subset=['startYear','runtimeMinutes'])

m = movie_rating_df['numVotes'].quantile(0.8)
print(m)

"""# [Pertanyaan 3: Bagaimana cara membuat fungsi weighted formula?](https://academy.dqlab.id/main/projectcode/212/382/1943?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')
rating_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.ratings.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]
movie_df = movie_df.loc[movie_df['genres'].notnull()]
movie_df['startYear'] = movie_df['startYear'].replace('\\N', np.nan)
movie_df['startYear'] = movie_df['startYear'].astype('float64')
movie_df['endYear'] = movie_df['endYear'].replace('\\N', np.nan)
movie_df['endYear'] = movie_df['endYear'].astype('float64')
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].replace('\\N', np.nan)
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].astype('float64')

def transform_to_list(x):
    if ',' in x: 
        return x.split(',')
    else: 
        return []

movie_df['genres'] = movie_df['genres'].apply(lambda x: transform_to_list(x))

movie_rating_df = pd.merge(movie_df, rating_df, on='tconst', how='inner')
movie_rating_df = movie_rating_df.dropna(subset=['startYear','runtimeMinutes'])

def imdb_weighted_rating(df, var=0.8):
    v = df['numVotes']
    R = df['averageRating']
    C = df['averageRating'].mean()
    m = df['numVotes'].quantile(var)
    df['score'] = (v/(m+v))*R + (m/(m+v))*C #Rumus IMDb 
    return df['score']
    
imdb_weighted_rating(movie_rating_df)

#melakukan pengecekan dataframe
print(movie_rating_df.head())

"""# [Pertanyaan 4: Bagaimana cara membuat simple recommender system?](https://academy.dqlab.id/main/projectcode/212/382/1944?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')
rating_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.ratings.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]
movie_df = movie_df.loc[movie_df['genres'].notnull()]
movie_df['startYear'] = movie_df['startYear'].replace('\\N', np.nan)
movie_df['startYear'] = movie_df['startYear'].astype('float64')
movie_df['endYear'] = movie_df['endYear'].replace('\\N', np.nan)
movie_df['endYear'] = movie_df['endYear'].astype('float64')
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].replace('\\N', np.nan)
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].astype('float64')

def transform_to_list(x):
    if ',' in x: 
        return x.split(',')
    else: 
        return []

movie_df['genres'] = movie_df['genres'].apply(lambda x: transform_to_list(x))

movie_rating_df = pd.merge(movie_df, rating_df, on='tconst', how='inner')
movie_rating_df = movie_rating_df.dropna(subset=['startYear','runtimeMinutes'])

C = movie_rating_df['averageRating'].mean()
m = movie_rating_df['numVotes'].quantile(0.8)

def imdb_weighted_rating(df, var=0.8):
    v = df['numVotes']
    R = df['averageRating']
    C = df['averageRating'].mean()
    m = df['numVotes'].quantile(var)
    df['score'] = (v/(m+v))*R + (m/(m+v))*C
    return df['score']
    
imdb_weighted_rating(movie_rating_df)

def simple_recommender(df, top=100):
    df = df.loc[df['numVotes'] >= m]
    df = df.sort_values(by='score',ascending=False) #urutkan dari nilai tertinggi ke terendah
    
    #Ambil data 100 teratas
    df = df[:top]
    return df
    
#Ambil data 25 teratas     
print(simple_recommender(movie_rating_df, top=25))

"""# [Pertanyaan 5: Bagaimana cara membuat simple recommender system dengan user preferences?](https://academy.dqlab.id/main/projectcode/212/382/1945?pr=)"""

import pandas as pd
import numpy as np
pd.set_option('display.max_columns', None)

movie_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.basics.tsv', sep='\t')
rating_df = pd.read_csv('https://storage.googleapis.com/dqlab-dataset/title.ratings.tsv', sep='\t')

movie_df = movie_df.loc[(movie_df['primaryTitle'].notnull()) & (movie_df['originalTitle'].notnull())]
movie_df = movie_df.loc[movie_df['genres'].notnull()]
movie_df['startYear'] = movie_df['startYear'].replace('\\N', np.nan)
movie_df['startYear'] = movie_df['startYear'].astype('float64')
movie_df['endYear'] = movie_df['endYear'].replace('\\N', np.nan)
movie_df['endYear'] = movie_df['endYear'].astype('float64')
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].replace('\\N', np.nan)
movie_df['runtimeMinutes'] = movie_df['runtimeMinutes'].astype('float64')

def transform_to_list(x):
    if ',' in x: 
        return x.split(',')
    else: 
        return []

movie_df['genres'] = movie_df['genres'].apply(lambda x: transform_to_list(x))

movie_rating_df = pd.merge(movie_df, rating_df, on='tconst', how='inner')
movie_rating_df = movie_rating_df.dropna(subset=['startYear','runtimeMinutes'])

C = movie_rating_df['averageRating'].mean()
m = movie_rating_df['numVotes'].quantile(0.8)

def imdb_weighted_rating(df, var=0.8):
    v = df['numVotes']
    R = df['averageRating']
    C = df['averageRating'].mean()
    m = df['numVotes'].quantile(var)
    df['score'] = (v/(m+v))*R + (m/(m+v))*C
    return df['score']
    
imdb_weighted_rating(movie_rating_df)

def simple_recommender(df, top=100):
    df = df.loc[df['numVotes'] >= m]
    df = df.sort_values(by='score', ascending=False)
    
    #jika kamu hanya ingin mengambil 100 teratas
    df = df[:top]
    return df

df = movie_rating_df.copy()

def user_prefer_recommender(df, ask_adult, ask_start_year, ask_genre, top=100):
    #ask_adult = yes/no
    if ask_adult.lower() == 'yes':
        df = df.loc[df['isAdult'] == 1]
    elif ask_adult.lower() == 'no':
        df = df.loc[df['isAdult'] == 0]

    #ask_start_year = numeric
    df = df.loc[df['startYear'] >= int(ask_start_year)]

    #ask_genre = 'all' atau yang lain
    if ask_genre.lower() == 'all':
        df = df
    else:
        def filter_genre(x):
            if ask_genre.lower() in str(x).lower():
                return True
            else:
                return False
        df = df.loc[df['genres'].apply(lambda x: filter_genre(x))]

    df = df.loc[df['numVotes'] >= m]  #Mengambil film dengan numVotes yang lebih besar atau sama dengan nilai m 
    df = df.sort_values(by='score', ascending=False)
    
    #jika kamu hanya ingin mengambil 100 teratas
    df = df[:top]
    return df

print(user_prefer_recommender(df,
                       ask_adult = 'no',
                        ask_start_year = 2000,
                       ask_genre = 'drama'
                       ))